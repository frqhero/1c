&НаКлиенте
Процедура Команда1(Команда)
    
    Повторно = ЕстьРеквизитИлиСвойствоОбъекта();
    ВПоискНаСервере(Повторно);
    
КонецПроцедуры

&НаСервере
Процедура ВПоискНаСервере(Повторно)
    
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ
    |    ДанныеСмены.Ссылка КАК Ссылка,
    |    ДанныеСмены.Дата КАК Дата,
    |    ДанныеСмены.СоСкольки КАК СоСкольки,
    |    ДанныеСмены.ДоСкольки КАК ДоСкольки
    |ИЗ
    |    Документ.ДанныеСмены КАК ДанныеСмены";
        
    ТаблицаЗапроса = Запрос.Выполнить().Выгрузить();
    СоздатьТаблицуФормы(ТаблицаЗапроса, Повторно);
    
КонецПроцедуры

&НаСервере
Процедура СоздатьТаблицуФормы(ТаблицаЗапроса, Повторно)
    
    Если Не Повторно Тогда
        
        МассивТипаВыбора = Новый Массив;
        МассивТипаВыбора.Добавить(Тип("ТаблицаЗначений"));
        
        ОписаниеТипаВыбора = Новый ОписаниеТипов(МассивТипаВыбора);
        
        МассивРеквизитов = Новый Массив;
        МассивРеквизитов.Добавить(Новый РеквизитФормы("РезультатЗапроса", ОписаниеТипаВыбора, "", "ТЗН"));
        
        Для Каждого Колонка Из ТаблицаЗапроса.Колонки Цикл
            
            МассивРеквизитов.Добавить(Новый РеквизитФормы(Колонка.Имя, Колонка.ТипЗначения, "РезультатЗапроса"));
            
        КонецЦикла;
        ИзменитьРеквизиты(МассивРеквизитов);
        
        ТаблицаПолейВыбора = Элементы.Добавить("ТЗН", Тип("ТаблицаФормы"));
        ТаблицаПолейВыбора.ПутьКДанным = "РезультатЗапроса";
        ТаблицаПолейВыбора.Отображение = ОтображениеТаблицы.Список;
        
        Для Каждого Колонка Из ТаблицаЗапроса.Колонки Цикл
            
            НовыйЭлемент = Элементы.Добавить(Колонка.Имя, Тип("ПолеФормы"), ТаблицаПолейВыбора);
            НовыйЭлемент.Вид = ВидПоляФормы.ПолеВвода;
            НовыйЭлемент.ПутьКДанным = "РезультатЗапроса." + Колонка.Имя;
            
        КонецЦикла;
        
    КонецЕсли;
    
    ЗначениеВРеквизитФормы(ТаблицаЗапроса, "РезультатЗапроса");
    
КонецПроцедуры

&НаКлиенте
Функция ЕстьРеквизитИлиСвойствоОбъекта()
    
    КлючУникальности   = Новый УникальныйИдентификатор;
    СтруктураРеквизита = Новый Структура("РезультатЗапроса", КлючУникальности);
    ЗаполнитьЗначенияСвойств(СтруктураРеквизита, ЭтотОбъект);
    
    Возврат СтруктураРеквизита["РезультатЗапроса"] <> КлючУникальности;
    
КонецФункции
